# Ralph Progress Log
Started: Tue Jan 27 12:24:29 PM -03 2026
---

## Codebase Patterns
- trip-planner-web is at /home/lcc/yopki/trip-planner-web (monorepo with turbo)
- Commit messages must be lowercase after `feat:` (commitlint enforced)
- `npx playwright install --with-deps` requires sudo on Arch Linux; use `npx playwright install` without system deps flag
- Playwright browsers have a host validation warning for missing system libs (libicu74, libxml2, libflite1)
- WebKit projects fail entirely on Arch Linux; use chromium/firefox/pixel5 for reliable testing
- e2e directory structure: e2e/{desktop,mobile,shared,fixtures,page-objects}

---

## 2026-01-27 - US-001
- Installed @playwright/test and playwright as devDependencies
- Created playwright.config.ts at repo root
- Installed browser binaries via npx playwright install
- Files changed: package.json, package-lock.json, playwright.config.ts
- Regression test added: RT-001 (pre-existing)
- **Learnings for future iterations:**
  - trip-planner-web is at /home/lcc/yopki/trip-planner-web
  - Commitlint enforces lowercase subject after type prefix
  - Arch Linux needs manual sudo for playwright system deps
---

## 2026-01-27 - US-002
- Configured 5 Playwright projects: desktop-chromium, desktop-firefox, desktop-webkit, mobile-pixel5, mobile-iphone12
- Desktop projects target localhost:3005, mobile projects target localhost:3006
- Added test:e2e, test:e2e:desktop, test:e2e:mobile scripts to package.json
- Files changed: playwright.config.ts, package.json
- Regression test added: RT-002 (pre-existing, updated command)
- **Learnings for future iterations:**
  - Commitlint rejects sentence-case subjects; use all lowercase after `feat:`
  - `npx playwright test --list` returns exit 1 when no test files exist
  - Desktop projects use testMatch: ['desktop/**', 'shared/**'], mobile uses ['mobile/**', 'shared/**']
---

## 2026-01-27 - US-003
- Created scripts/e2e-services.sh: starts NATS (Docker), nhost, and turbo dev; waits for ports 3005/3006; tears down on exit
- Created scripts/e2e-check-services.sh: validates web-desktop (3005), web-mobile (3006), and NATS container
- Files changed: scripts/e2e-services.sh, scripts/e2e-check-services.sh
- Regression test added: RT-003a
- **Learnings for future iterations:**
  - Project uses remote Nhost endpoints (not local Docker); nhost CLI is optional
  - turbo dev starts both web-desktop (3005) and web-mobile (3006) via npm run dev
  - Commitlint rejects uppercase in subject; use `us-003` not `US-003`
  - nc -z is used for port checking; available on most Linux systems
---

## 2026-01-27 - US-004
- Added Playwright MCP server configuration to yopki-dev/.mcp.json
- Command: `npx @playwright/mcp@latest`
- Files changed: /home/lcc/yopki/yopki-dev/.mcp.json
- Regression test added: RT-004
- **Learnings for future iterations:**
  - yopki-dev/.mcp.json is the project-level MCP config (not trip-planner-web)
  - @playwright/mcp@latest is the package for Playwright MCP server
  - MCP config changes are committed to yopki-dev repo (main branch), not the ralph worktree
---

## 2026-01-27 - US-005
- Created e2e directory structure with .gitkeep files for empty dirs (desktop, mobile, fixtures)
- HomePage page object and navigation smoke test already existed from prior iteration
- Added Playwright entries to .gitignore (test-results, playwright-report, blob-report, playwright/.cache)
- Committed all e2e structure files
- Files changed: e2e/desktop/.gitkeep, e2e/mobile/.gitkeep, e2e/fixtures/.gitkeep, e2e/page-objects/HomePage.ts, e2e/shared/navigation.spec.ts, .gitignore
- Regression test added: RT-005
- **Learnings for future iterations:**
  - WebKit-based projects (desktop-webkit, mobile-iphone12) fail on Arch Linux due to missing system libs (libicu74, libxml2, libflite1)
  - Use `--project=desktop-chromium` for quick single-project test runs
  - Smoke tests use https://example.com to avoid needing local services running
---
